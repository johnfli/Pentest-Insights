# <img src="https://raw.githubusercontent.com/johnfli/Pentest-Insights/master/src/main/webapp/images/logos/readme/logo.png" width="48" height="48" title="Pentest Insights Logo"> Pentest Insights
#### CYBER SECURITY TOOL

**Pentest Insights** is a **Cyber Security Insights Tool** developed for the purposes of the developer's diploma thesis on 
Electrical & Computers Engineering. The tool offers **Security Testing** through **Functional Testing** and is an 
**end-to-end java project**.

## Tech Information

The frontend is built with the [Vaadin Framework](https://vaadin.com/) which makes it a
Progressive Web App, suitable both for desktop and mobile devices. On the backend side of the project we have
[Spring Boot](https://spring.io/projects/spring-boot) 
for the repositories, entities and services combined with [Maven](https://maven.apache.org/) for Functional Testing 
execution. 

To be more precise, Maven is embedded into the application through 
[Maven Embedder](https://maven.apache.org/ref/3.6.3/maven-embedder/index.html) 
in order to execute a [Selenium Java](https://www.selenium.dev/documentation/en/) project (located into the 
[security-project](https://github.com/johnfli/Pentest-Insights/tree/master/security-project) folder) with the desired 
functional tests.
The browser created for the functional tests' execution proxies through an [OWASP ZAP](https://www.zaproxy.org/) instance.
As soon as Functional Testing is completed, the project drives the [OWASP ZAP](https://www.zaproxy.org/) instance through
it's [Java API](https://github.com/zaproxy/zap-api-java) in order to perform several types of Crawling and Scanning on 
the targeted web application so that the most obvious security vulnerabilities are exploited and reported. The results
are presented in graphical and comparative charts, as well as analytical grids. 

As for the database, an embedded 
[H2 Database](https://www.h2database.com/html/main.html) is used in order to provide more portability. This makes the 
whole project standalone, which means that given the .jar into the root folder it should be able to run on any machine with
the single requirement of a [Java](https://openjdk.java.net/) JDK or JRE installed.
Note that the project has been pre-configured to connect to a [MySQL Database](https://www.mysql.com/) as well, thus 
switching to that configuration is as easy as uncommenting [a couple of lines](https://github.com/johnfli/Pentest-Insights/blob/master/src/main/resources/application.properties#L6-L7) 
and commenting out [a couple of others](https://github.com/johnfli/Pentest-Insights/blob/master/src/main/resources/application.properties#L10-L16).
  
## <img src="https://raw.githubusercontent.com/johnfli/Pentest-Insights/master/src/main/webapp/images/logos/readme/maven.png" width="95" height="24" title="Maven Logo"> Running Pentest Insights in Development Mode

Running Pentest Insights locally, either in Development or in Production Mode has some specific requirements:
1. [Java JDK 11](https://www.oracle.com/java/technologies/javase-jdk11-downloads.html) or later,
2. [Maven 3.6.3](https://maven.apache.org/download.cgi) or later,
3. [OWASP ZAP 2.9.0]() (exact version, the link may correspond to a later version, in which case it has to be installed through the [equivalent docker image](https://hub.docker.com/layers/owasp/zap2docker-stable/2.9.0/images/sha256-3563ecc53448ad224262ccea185cff8360c999c52d9c4b78630d9344dc1c3fd6?context=explore)),
4. [Chrome](https://www.google.com/chrome/) and [Firefox](https://www.mozilla.org/en-US/exp/firefox/new/) browsers,
5. The target app.

To spin the app, open a terminal into the root folder of the project and instruct the command:

```
mvn spring-boot:run
```

Wait for the application to start and point your browser at http://localhost:8000/ to view the application.

If you want to the package the application into an executable jar that can run on any machine open a terminal into the 
root folder of the project and instruct the command:

```
mvn clean package
```

Wait for the package to complete and copy the .jar file from the target folder into the root folder, open a terminal
into the root folder and type the command `java -jar pentest-insights-2.0-SNAPSHOT.jar`.
 
Wait for the application to start and point your browser at http://localhost:8000/ to view the application.

## <img src="https://raw.githubusercontent.com/johnfli/Pentest-Insights/master/src/main/webapp/images/logos/readme/maven.png" width="95" height="24" title="Maven Logo"> Running Pentest Insights in Production Mode

The default mode when the application is built or started is 'development'. The 'production' mode is turned on by 
passing the `production` argument when building or starting the app.

Thus, open a terminal into the root folder of the project and instruct the command:
```
mvn spring-boot:run -Pproduction
```

Wait for the application to start and point your browser at http://localhost:8000/ to view the application.

If you want to the package the application into an executable jar that can run on any machine in production mode open a 
terminal into the root folder of the project and instruct the command:

```
mvn clean package -Pproduction
```

Wait for the package to complete and copy the .jar file from the target folder into the root folder, open a terminal
into the root folder and type the command `java -jar pentest-insights-2.0-SNAPSHOT.jar`.
 
Wait for the application to start and point your browser at http://localhost:8000/ to view the application.

Note that if you switch between running in production mode and development mode, you need to instruct an
```
mvn clean
```
before running in the other mode.

## <img src="https://raw.githubusercontent.com/johnfli/Pentest-Insights/master/src/main/webapp/images/logos/readme/docker.png" width="34" height="24" title="Docker Logo"> Running Pentest Insights on Docker

The [docker-compose](docker-compose.yml) file makes sure a network of images is built on behalf of the user, so that he/she 
does not have to take care of each detail manually, to be more specific:
1. A [Selenium Grid](https://hub.docker.com/r/selenium/hub/) image, to control the browsers for the functional tests,
2. A [Chrome browser](https://hub.docker.com/r/selenium/node-chrome-debug) image, to execute the browser,
3. A [Firefox browser](https://hub.docker.com/r/selenium/node-firefox-debug) image, to execute the browser,
4. An [OWASP ZAP 2.9.0](https://hub.docker.com/r/owasp/zap2docker-stable/) image, to execute the security tests,
5. A [Damn Vulnerable Web Application (DVWA)](https://hub.docker.com/r/vulnerables/web-dvwa/) image and a [BodgeIt Store](https://hub.docker.com/r/psiinon/bodgeit) image, two apps with known vulnerabilities to begin with,
6. A pre-built [Pentest Insights](https://hub.docker.com/r/johnfli/pentest-insights) image, to run the scannings.

Open a terminal into the root folder of the project and instruct the command:

```
docker-compose up
```

Docker will fetch all the needed images in order to build the network. This will take some time the first time, so better 
grab a cup of coffee. Wait for the application to start and point your browser at http://localhost:8000/, for Linux, or 
at [http://docker-machine-ip:8000/](http://docker-machine-ip:8000/), for Windows and MacOS, to view the application.


When you are done simply hit `Ctrl + C` and optionally clean the created containers up with: 

```
docker-compose down
```
Where [docker-machine-ip]() stands for the IP result of instructing the command `docker-machine ip` inside a simple terminal on your machine.

## <img src="https://raw.githubusercontent.com/johnfli/Pentest-Insights/master/src/main/webapp/images/logos/readme/docker.png" width="34" height="24" title="Docker Logo"> Building Pentest Insights on Docker

In case you want to edit the code of the application and run the updated project into Docker all you have to do is to
uncomment line [83](https://github.com/johnfli/Pentest-Insights/blob/c230ae037f4d6e32d5fa5374883d52ef6d1c4340/docker-compose.yml#L83) 
of the [docker-compose](docker-compose.yml) file and then open a terminal into the root folder of the project and instruct 
the command:

```
docker-compose build
```

Wait for the build to complete and instruct the command:

```
docker-compose up
```
Wait for the application to start and point your browser at http://localhost:8000/, for Linux, or 
at [http://docker-machine-ip:8000/](http://docker-machine-ip:8000/), for Windows and MacOS, to view the application.

Again when you are done simply hit `Ctrl + C` and optionally clean the created containers up with: 

```
docker-compose down
```
Where [docker-machine-ip]() stands for the IP result of instructing the command `docker-machine ip` inside a simple terminal on your machine.

## <img src="https://raw.githubusercontent.com/johnfli/Pentest-Insights/master/src/main/webapp/images/logos/readme/docker.png" width="34" height="24" title="Docker Logo"> Building and Running Pentest Insights on Docker Standalone

In case you want to build and run **Pentest Insights** on **Docker** without the whole network that comes along with the 
[docker-compose](docker-compose.yml) file, open a terminal into the root folder of the project and instruct the 
commands:

```
docker build -t pentest-insights:<any-tag-you-may-like>

docker run --network host --add-host="owasp-bwa:<ip-of-target-app-VM> --rm --name pentest-insights -i pentest-insights:<the-tag-you-entered-when-building>
```
Wait for the application to start and point your browser at http://localhost:8000/, for Linux, or 
at [http://docker-machine-ip:8000/](http://docker-machine-ip:8000/), for Windows and MacOS, to view the application.

Then you can enter the container through a bash shell if you like as well, by simply instructing the command:
```
docker exec -it pentest-insights /bin/bash
```
Where [docker-machine-ip]() stands for the IP result of instructing the command `docker-machine ip` inside a simple terminal on your machine.

## More Information

- [x] OWASP ZAP listens on port 8090 of localhost, if you need to alter those you can do so, by simply editing the 
        equivalent properties of the [config.properties](security-project/src/test/resources/config.properties) file 
        inside the [security-project](security-project) folder:
        
            ZAP_HOST_IP=127.0.0.1
            ZAP_HOST_PORT=8090

    For more info on the rest of the properties of the [config.properties](security-project/src/test/resources/config.properties) file check the 
    [security-project readme.md](security-project/README.md) file.
  
- [x] The app comes with 3 pre-configured users:

    |     Username     |        Password       |          Role          |      Description     |
    |------------------|-----------------------|------------------------|----------------------|
    |      admin       |         admin         |         ADMIN          | Administrator user priviledges showcase |
    |      damnvul     |        Damn0000       |         USER           | Simple user for the Damn Vulnerable Web Application (DVWA), with some example scannings|
    |      bodgeit     |        Bodge0000      |         USER           | Simple user for the BodgeIt Store, with some example scannings |


- [x] On how to use the application to request a scanning

    [![Pentest Insights: Requesting a Scanning Video](http://img.youtube.com/vi/xocs-Ld6Epg/0.jpg)](http://www.youtube.com/watch?v=xocs-Ld6Epg "Pentest Insights: Requesting a Scanning")

- [x] On how to interpret your scanning results

    [![Pentest Insights: Getting the Results Video](http://img.youtube.com/vi/v8sgpbzlVJc/0.jpg)](http://www.youtube.com/watch?v=v8sgpbzlVJc "Pentest Insights: Getting the Results")

- [x] Note that when the app is installed with the Docker Compose option the functional tests may be monitored through a VNC Viewer window,
        all you have to do is:

    - [Download](https://www.realvnc.com/en/connect/download/viewer/) and install VNC Viewer on your machine,
    
    - Open VNC Viewer and search for: 
    
        [docker-machine-ip:5900](), if Chrome was the desired browser, or  
        [docker-machine-ip:5901](), if Firefox was the desired browser
    
    - Use the password `secret`, if prompted to insert one.

Where [docker-machine-ip]() stands for the IP result of instructing the command `docker-machine ip` inside a simple terminal on your machine.

## License
A paid Pro or Prime subscription is required for creating a new software project from this starter, but due to the 
[Vaadin Student Program](https://vaadin.com/blog/vaadin-pro-available-for-students) all students are offered the Pro 
subscription for free. After its creation, results can be used, developed and distributed freely, but licenses for the 
used commercial components are required during development. The starter or its parts cannot be redistributed as a 
code example or template.

For full terms, see LICENSE
